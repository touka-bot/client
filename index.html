<!DOCTYPE html>
<html>

<head>
    <title>FLUID v2</title>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <input type="text" class="search-input" id="center" placeholder="Search a Show">
    <button id="center" class="search-button" onclick="searchTitle('noragami')">Search</button>
</body>

<script>
    function searchTitle(title) {
        var show = document.getElementsByClassName('search-input')[0].value;
        if (show == "")
            return alert('Please enter a Show');

        const Http = new XMLHttpRequest();
        const url = 'http://4c3711.xyz:3000/fluid/api/v1/search/' + show.toLowerCase().replace(" ", "+");
        Http.open("GET", url);
        Http.send();

        Http.onreadystatechange = (e) => {
            let repoArray = new Array();
            repoArray = JSON.parse(Http.responseText);
            for (let i = 0; i < repoArray.length; i++) {
                var btn = document.createElement("BUTTON"); // Create a <button> element
                btn.innerHTML = repoArray[i].replace("https://4anime.to/anime/", "").replace("-", " "); // Insert text
                btn.setAttribute("onclick", `getEpisodes(${show}, ${i})`);
                document.body.appendChild(btn); // Append <button> to <body>
            }
        }
    }

    function getEpisodes(title, index) {
        const Http = new XMLHttpRequest();
        const url = `http://4c3711.xyz:3000/fluid/api/v1/search/${title}/${index}`;
        Http.open("GET", url);
        Http.send();

        Http.onreadystatechange = (e) => {
            let repoArray = new Array();
            console.log(Http.responseText);
        }
    }
</script>

</html>